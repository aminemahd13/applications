# ============================================
# Event Platform Environment Variables
# ============================================
# INSTRUCTIONS: Copy this file to .env and adjust values for your environment.

# ============================================
# 1. DATABASE (PostgreSQL)
# ============================================
# Connection URL: postgresql://[user]:[password]@[host]:[port]/[database]?schema=public
# - Development (Docker): host=localhost, port=5432
# - Production (Docker Network): host=postgres, port=5432
DATABASE_URL="postgresql://postgres:password@localhost:5432/events_platform?schema=public"

# Database credentials (used by Docker Compose to initialize DB)
POSTGRES_USER=postgres
POSTGRES_PASSWORD=password
POSTGRES_DB=events_platform

# ============================================
# 2. CACHE & QUEUE (Redis)
# ============================================
# Connection URL: redis://:[password]@[host]:[port]
# - Development: localhost
# - Production: redis
REDIS_URL="redis://localhost:6379"

# ============================================
# 3. FILE STORAGE (MinIO / S3)
# ============================================
# Endpoint should include protocol (http/https). 
# - Development: http://localhost:9000
# - Production (Internal): http://minio:9000
MINIO_ENDPOINT="http://localhost:9000"
MINIO_PORT=9000
MINIO_USE_SSL=false
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin

# Bucket Names (Created automatically by init script in dev)
MINIO_BUCKET_NAME="uploads"
# Public assets bucket (optional if using direct serving)
MINIO_PUBLIC_BUCKET="public-assets"

# Credentials for API to access MinIO
# In dev, matches ROOT_USER/PASSWORD. In prod, use standard AWS_ACCESS_KEY_ID style if using real S3.
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin

# ============================================
# 4. API SERVER CONFIGURATION
# ============================================
NODE_ENV=development
PORT=3001

# Security Secrets (Generate using `openssl rand -hex 32`)
JWT_SECRET="changeme-in-production-secure-jwt-secret-key-123"
SESSION_SECRET="changeme-in-production-secure-session-secret-key-456"

# CORS & Cookies
CORS_ORIGIN="http://localhost:3000"
COOKIE_DOMAIN="" # Leave empty for localhost, set to .yourdomain.com for prod
APP_BASE_URL="http://localhost:3000"

# ============================================
# 5. FRONTEND CONFIGURATION (Next.js)
# ============================================
# Direct Public API URL (Browser -> API)
NEXT_PUBLIC_API_URL="http://localhost:3001/api/v1"

# Root Domain for Subdomain Routing (e.g., "mathmaroc.org")
NEXT_PUBLIC_ROOT_DOMAIN="localhost"

# Routing Mode ("path" | "subdomain")
# - path: http://localhost:3000/events/my-event
# - subdomain: http://my-event.localhost:3000
NEXT_PUBLIC_ROUTING_MODE="path"

# Asset Configuration
# Where browsers should fetch images from. if empty, proxies through Next.js/API.
# NEXT_PUBLIC_ASSET_HOST="https://assets.mathmaroc.org"
NEXT_PUBLIC_ASSET_HOST=""
NEXT_PUBLIC_DIRECT_ASSET_HOST=""

# ============================================
# 6. MAIL (SMTP)
# ============================================
# Development: MailHog (localhost:1025)
# Production: AWS SES, SendGrid, etc.
SMTP_HOST="localhost"
SMTP_PORT=1025
SMTP_USER=""
SMTP_PASS=""
SMTP_FROM="noreply@event-platform.com"

# ============================================
# 7. PERFORMANCE & TUNING (Optional)
# ============================================
SESSION_REVOKE_SCAN_FALLBACK=false
SESSION_REVOKE_SCAN_MAX_KEYS=5000
AUDIT_QUEUE_MAX_SIZE=2000
AUDIT_MAX_RETRIES=2
AUDIT_EVENT_LOOKUP_CACHE_TTL_MS=120000
