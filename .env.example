# ============================================
# Event Platform Environment Variables
# ============================================
# Copy this file to .env and fill in values

# ============================================
# DATABASE
# ============================================
DATABASE_URL="postgresql://postgres:password@localhost:5432/events_platform?schema=public"

# ============================================
# REDIS (Sessions, Rate Limiting, Caching)
# ============================================
REDIS_URL="redis://localhost:6379"

# ============================================
# MINIO / S3 (File Storage)
# ============================================
MINIO_ENDPOINT="http://localhost:9000"
MINIO_ACCESS_KEY="minioadmin"
MINIO_SECRET_KEY="minioadmin"
# Bucket names (created automatically by docker-compose minio-init)
# MINIO_UPLOADS_BUCKET="uploads"
# MINIO_PUBLIC_ASSETS_BUCKET="public-assets"

# ============================================
# AUTHENTICATION & SECURITY
# ============================================
# JWT secret for ticket tokens (QR codes)
JWT_SECRET="your-super-secure-jwt-secret-change-in-production"

# Session secret for express-session
SESSION_SECRET="your-super-secure-session-secret-change-in-production"

# Cookie domain (for cross-subdomain sessions)
# Leave empty for localhost development
COOKIE_DOMAIN=

# ============================================
# API SERVER
# ============================================
# Port the NestJS API runs on
PORT=3001

# Environment mode
NODE_ENV=development

# ============================================
# FRONTEND (Next.js)
# ============================================
# API URL the frontend calls
NEXT_PUBLIC_API_URL="http://localhost:3001/api/v1"

# Public asset host (Microsite images, etc.)
NEXT_PUBLIC_ASSET_HOST="https://public-assets.mathmaroc.org"
# Optional direct asset host override used when NEXT_PUBLIC_ASSET_HOST is empty.
# Example (single-host nginx): http://localhost/uploads
NEXT_PUBLIC_DIRECT_ASSET_HOST=""

# Root domain for host-based routing
NEXT_PUBLIC_ROOT_DOMAIN="mathmaroc.org"

# Routing mode: "path" or "subdomain"
# - path: Events at /events/:slug (easier for local dev)
# - subdomain: Events at :slug.mathmaroc.org (production)
NEXT_PUBLIC_ROUTING_MODE=path

# ============================================
# EMAIL (Optional - uses MailHog in dev)
# ============================================
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_USER=
SMTP_PASS=
SMTP_FROM="noreply@mathmaroc.org"

# ============================================
# OPTIONAL PERFORMANCE TUNING
# ============================================
# Enable legacy O(N) session scan fallback only when needed for migration cleanup.
SESSION_REVOKE_SCAN_FALLBACK=false
SESSION_REVOKE_SCAN_MAX_KEYS=5000

# Async audit queue controls (request-path protection)
AUDIT_QUEUE_MAX_SIZE=2000
AUDIT_MAX_RETRIES=2
AUDIT_EVENT_LOOKUP_CACHE_TTL_MS=120000

# ============================================
# PRODUCTION ONLY
# ============================================
# CORS origins (comma-separated)
# CORS_ORIGINS="https://mathmaroc.org,https://www.mathmaroc.org"

# Force HTTPS cookies
# NODE_ENV=production

# ============================================
# DOCKER COMPOSE DEFAULTS (for reference)
# ============================================
# PostgreSQL: postgres:password@localhost:5432/events_platform
# Redis: redis://localhost:6379
# MinIO: http://localhost:9000 (console: http://localhost:9001)
# MailHog: smtp://localhost:1025 (UI: http://localhost:8025)
